<!DOCTYPE html>
<head>
	<meta name='viewport' content='user-scalable=no, width=device-width,initial-scale=1, maximum-scale=1' />
    <title>CRC Stats Page</title>
<script src="http://d3js.org/d3.v3.min.js"></script>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css" />
<link rel="stylesheet" href="{{url_root}}/media/mobile/css/stats.css" />
<script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js?2"></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/jquery-mobile/jquery-1.10.2.min.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/cartogram.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/topojson.js'></script>
</head>

<script>
$( document ).ready(function() {
    $(".spanish").hide();
});
</script>

<body>

<!--<div class="home-btn-dialog-box">
    <img width="30px;" class='back-btn-dialog' src="{{url_root}}/media/mobile/img/cafe/CRC_back_bttn.png">
    <a href="{{url_root}}/"><img width="30px;" id="home-btn" class='home-btn-dialog' src="{{url_root}}/media/mobile/img/cafe/CRC_home_bttn.png"></a>
    <img width="30px;" id="help-btn" class='help-btn-dialog' src="{{url_root}}/media/mobile/img/cafe/CRC_help_bttn.png">
</div>-->

<br>
<center>

<div class="stats-section">

<div style="text-align: right; width: 100%;">
<a href="#" class="english" onclick="$('.english').hide();$('.spanish').show();">Español</a>
<a href="#" class="spanish" onclick="$('.spanish').hide();$('.english').show();">English</a>
</div>

<span class="english">Date:</span><span class="spanish">La fecha:</span>

<strong>{{date}}</strong><br>
    <span class="english">Over <strong>10,000</strong> people from all 58 counties have visited and over <strong>30,000</strong> grades have been entered so far.</span>
    <span class="spanish"><strong>10 000</strong> personas de los 58 condados han concedido más de <strong>30 000</strong> notas al estado de California</span></div>

<br>
<hr>
<div class="stats-section-title" id="geodistribution">
    <div class="stats-label-big">
        <span class="english">Median Grades For Each County</span>
        <span class="spanish">Calificación media por condado</span>
    </div><br>

    <select id="CA_selector" class="english" onchange="changeData(this)" >
	{% for median in medians %}
	<option value="{{median.id}}">{{median.id}}. {{ median.statement.short_version}}</option>
	{% endfor %}
    </select>

    <select id="CA_selector" class="spanish" onchange="changeData(this)" >
    {% for median in medians %}
    <option value="{{median.id}}">{{median.id}}. {{ median.statement.spanish_short_version}}</option>
    {% endfor %}
    </select>

    <br/><br>

    <!--<script>
        $.get("{{url_root}}/media/mobile/js/geostat.js")
            .fail(function() { 
            $( "#geodistribution" ).html( "<div class='stats-label-big'>GEOGRAPHIC DISTRIBUTION <br/> OF MEDIAN GRADES ASSIGNED</div><br><br><span style=' font-size:14px;color: #f5ebde;'>We will present geographical distribution soon</span><br/><br>" );
            document.getElementById( "#geodistribution" ).style.height="40px";
            })
    </script>-->
    <center>
        <button type="button" onclick="map_grade_update()"><span class="english">Click to transform the map to a cartogram</span><span class="spanish">Clic para transformar el mapa a un cartograma</span></button>
        <div id="map" style="height: 370px; width:360px;"></div>
        <span class="english">The cartogram distorts the map so that each county's area is proportional to its population.</span>
        <span class="spanish">El cartograma distorciona el mapa de manera que el área de cada condado es proporcional a su población</span>
</center>
</div>
<br>
<hr>
<div class="stat-section-title" id="geopercapita">
     <div class="stats-label-big">
        <span class="english">Participants per 10,000 County Residents</span>
            <span class="spanish">Participantes por 10.000 residentes de los condados</span>
    </div><br>
    <!--<script>
        $.get("{{url_root}}/media/mobile/js/geostat_population.js")
            .fail(function() { 
            $( "#geopercapita" ).html( "<div class='stats-label-big'>PARTICIPANTS PER  <br/> 10000 POPULATION</div><br><br><span style=' font-size:14px;color: #f5ebde;'>We will present geographical participantion soon</span><br/><br>" );
            document.getElementById( "#geodistribution" ).style.height="40px";
            })
    </script>-->
    <button type="button" onclick="map_capita_update()"><span class="english">Click to transform the map to a cartogram</span><span class="spanish">Clic para transformar el mapa a un cartograma</span></button>
    <div id="map_capita" style="height: 370px; width:360px;"></div>
    <span class="english">The cartogram distorts the map so that each county's area is proportional to its population.</span>
        <span class="spanish">El cartograma distorciona el mapa de manera que el área de cada condado es proporcional a su población</span>
</div>
<br>
<hr>


<div class="stats-section-title">
    <div class="stats-label-big">
        <span class="english">Histogram of Grades</span>
        <span class="spanish">Histograma de calificaciones</span>
    </div>

<div class='dialog dialog-style'>
  <center>       
          {% for k,v in statement_hist.iteritems %}
          
    <div class="compare-box-{{k.id}}" style="padding-bottom: 10px;width: 310px; margin: 20px; display: inline-block">
            
            <span class="english">{{k.statement}}</span>
            <span class="spanish">{{k.spanish_statement}}</span>

            <canvas id="sparkLineCanvas{{k.id}}" width="300" height="80"></canvas>
            
            <div>

        <script>
         var canvas = document.getElementById('sparkLineCanvas{{k.id}}');
         var context = canvas.getContext('2d');

         //if ({{k.id}} % 2 == 1)
         //    $('.compare-box-{{k.id}}').css("background-color","rgba(0,0,0,0.05)")

         var data = {{v}};
         var max_of_array = Math.max.apply(Math, data);

         //window.statement_processed_data[({{k.id}}-1)] = data

         context.beginPath();
         context.lineWidth = 10;
         context.strokeStyle = '#442b10';
         context.shadowColor = '#ffffff';
               context.shadowOffsetX = 1;
               context.shadowOffsetY = 1;
         //context.moveTo(0, 45 - data[0]/max_of_array*38);
         for (i = 0; i <= 13; i++)
         {
          var skipOffset = 0
          if (i == 13)
            skipOffset = 7

     context.moveTo(i*21+5+skipOffset, 68);
     context.lineTo(i*21+5+skipOffset, 68 - data[i]/max_of_array*65);
     context.stroke(); 
         }

         context.font="italic small-caps bolder 12px sans-serif";
         context.fillStyle = '#442b10';
         context.fillText("A+",0,80);

         context.fillText("F",163,80);
         context.fillText("Ø",277,80);
        </script>

      </div>
            
          </div>
          {% endfor %}

      </div>

<span class="english"><h1>Thanks for participating!</h1></span>
<span class="spanish"><h1>¡Gracias por participar!</h1></span>

</div>

	</center>

<script type='text/javascript' src='{{url_root}}/media/mobile/js/map_capita_carto.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/map_grade_carto.js'></script>

<!--<script type='text/javascript' src='{{url_root}}/media/mobile/js/geostat.js'></script>-->
<!--<script type='text/javascript' src='{{url_root}}/media/mobile/js/map.js'></script>-->
<!--<script type='text/javascript' src='{{url_root}}/media/mobile/js/geostat_population.js'></script>-->
<!--<script type='text/javascript' src='{{url_root}}/media/mobile/js/map_capita.js'></script>-->
</body>
</html>
